# ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®èª­ã¿å–ã‚Šãƒ»æ›¸ãè¾¼ã¿æ“ä½œã®å®Ÿè·µ

**æ—¥ä»˜**: 2025å¹´10æœˆ27æ—¥
**å­¦ç¿’å†…å®¹**: Viemã‚’ä½¿ç”¨ã—ãŸã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®èª­ã¿å–ã‚Šãƒ»æ›¸ãè¾¼ã¿æ“ä½œã®å¤šæ§˜ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã€å®Ÿè·µçš„ãªä½¿ç”¨ä¾‹ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€ã‚¤ãƒ™ãƒ³ãƒˆç›£è¦–

## 1. èª­ã¿å–ã‚Šæ“ä½œã®è©³ç´°

### 1.1 åŸºæœ¬çš„ãªèª­ã¿å–ã‚Š

ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‹ã‚‰å€¤ã‚’èª­ã¿å–ã‚‹æœ€ã‚‚å˜ç´”ãªæ–¹æ³•ï¼š

```typescript
// æ–¹æ³•1: readContract ã‚’ä½¿ã£ãŸåŸºæœ¬çš„ãªèª­ã¿å–ã‚Š
const value = await publicClient.readContract({
  address: CONTRACT_ADDRESS,
  abi: CONTRACT_ABI,
  functionName: 'myUint'
})

console.log('myUint ã®å€¤:', value.toString())
console.log('å‹:', typeof value) // bigint
```

**ãƒã‚¤ãƒ³ãƒˆ**:
- `publicClient`: èª­ã¿å–ã‚Šå°‚ç”¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
- æˆ»ã‚Šå€¤ã¯å¸¸ã« `bigint` å‹
- `toString()` ã§æ–‡å­—åˆ—ã«å¤‰æ›

### 1.2 ä½ãƒ¬ãƒ™ãƒ«APIã‚’ä½¿ç”¨

é–¢æ•°ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã‚’ç›´æ¥ä½¿ç”¨ã—ãŸèª­ã¿å–ã‚Šï¼š

```typescript
// æ–¹æ³•2: ä½ãƒ¬ãƒ™ãƒ«APIï¼ˆeth_callï¼‰
// myUint()ã®function selector: 0x06540f7e
const data = await publicClient.call({
  to: CONTRACT_ADDRESS,
  data: '0x06540f7e'
})

console.log('ç”Ÿãƒ‡ãƒ¼ã‚¿:', data.data)

// 16é€²æ•°ã‚’BigIntã«å¤‰æ›
if (data.data) {
  const value = BigInt(data.data)
  console.log('ãƒ‡ã‚³ãƒ¼ãƒ‰å¾Œ:', value.toString())
}
```

**ã„ã¤ä½¿ã†ã¹ãã‹ï¼Ÿ**:
- ABIãŒãªã„å ´åˆ
- ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãŒå¿…è¦ãªå ´åˆ
- ãƒ‡ãƒãƒƒã‚°ç›®çš„

### 1.3 è¤‡æ•°å›ã®é€£ç¶šèª­ã¿å–ã‚Š

```typescript
// æ–¹æ³•3: è¤‡æ•°å›èª­ã¿å–ã‚Š
const values: bigint[] = []

for (let i = 0; i < 5; i++) {
  const value = await publicClient.readContract({
    address: CONTRACT_ADDRESS,
    abi: CONTRACT_ABI,
    functionName: 'myUint'
  })
  
  values.push(value)
  console.log(`èª­ã¿å–ã‚Š ${i + 1}: ${value}`)
  
  // å°‘ã—å¾…æ©Ÿï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
  await new Promise(resolve => setTimeout(resolve, 100))
}

console.log('ã™ã¹ã¦ã®å€¤:', values.map(v => v.toString()))
```

### 1.4 å®šæœŸçš„ãªç›£è¦–ï¼ˆãƒãƒ¼ãƒªãƒ³ã‚°ï¼‰

```typescript
// æ–¹æ³•4: å®šæœŸçš„ã«å€¤ã‚’ç›£è¦–
async function monitorValue(intervalMs: number = 5000, maxIterations: number = 3) {
  let previousValue: bigint | null = null
  let iteration = 0
  
  const intervalId = setInterval(async () => {
    const currentValue = await publicClient.readContract({
      address: CONTRACT_ADDRESS,
      abi: CONTRACT_ABI,
      functionName: 'myUint'
    })
    
    const timestamp = new Date().toLocaleTimeString()
    console.log(`[${timestamp}] ç¾åœ¨ã®å€¤: ${currentValue}`)
    
    // å€¤ãŒå¤‰ã‚ã£ãŸã‹ç¢ºèª
    if (previousValue !== null && currentValue !== previousValue) {
      console.log(`âš ï¸  å€¤ãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸ: ${previousValue} â†’ ${currentValue}`)
    }
    
    previousValue = currentValue
    iteration++
    
    if (iteration >= maxIterations) {
      clearInterval(intervalId)
    }
  }, intervalMs)
}
```

**ä½¿ç”¨ä¾‹**:
- ä¾¡æ ¼ç›£è¦–
- ã‚ªãƒ¼ã‚¯ã‚·ãƒ§ãƒ³ã®é€²è¡ŒçŠ¶æ³ç›£è¦–
- ã‚¬ãƒãƒŠãƒ³ã‚¹æŠ•ç¥¨ã®çŠ¶æ³ç¢ºèª

### 1.5 ãƒ–ãƒ­ãƒƒã‚¯æƒ…å ±ä»˜ãèª­ã¿å–ã‚Š

```typescript
// æ–¹æ³•5: ãƒ–ãƒ­ãƒƒã‚¯æƒ…å ±ä»˜ãèª­ã¿å–ã‚Š
const blockNumber = await publicClient.getBlockNumber()
console.log('ç¾åœ¨ã®ãƒ–ãƒ­ãƒƒã‚¯ç•ªå·:', blockNumber)

const value = await publicClient.readContract({
  address: CONTRACT_ADDRESS,
  abi: CONTRACT_ABI,
  functionName: 'myUint'
})

console.log(`ãƒ–ãƒ­ãƒƒã‚¯ ${blockNumber} æ™‚ç‚¹ã®å€¤: ${value}`)

// ãƒ–ãƒ­ãƒƒã‚¯ã®è©³ç´°æƒ…å ±
const block = await publicClient.getBlock({ blockNumber })
console.log('ãƒ–ãƒ­ãƒƒã‚¯ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—:', new Date(Number(block.timestamp) * 1000).toLocaleString())
```

### 1.6 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```typescript
// æ–¹æ³•6: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä»˜ã
try {
  const value = await publicClient.readContract({
    address: CONTRACT_ADDRESS,
    abi: CONTRACT_ABI,
    functionName: 'myUint'
  })
  
  console.log('âœ… èª­ã¿å–ã‚ŠæˆåŠŸ:', value.toString())
  return { success: true, value }
} catch (error: any) {
  console.error('âŒ èª­ã¿å–ã‚Šå¤±æ•—')
  
  if (error.message.includes('could not detect network')) {
    console.error('  åŸå› : AnvilãŒèµ·å‹•ã—ã¦ã„ã¾ã›ã‚“')
  } else if (error.message.includes('contract')) {
    console.error('  åŸå› : ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“')
  }
  
  return { success: false, error: error.message }
}
```

### 1.7 å€¤ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

```typescript
// æ–¹æ³•7: å€¤ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¾‹
const value = await publicClient.readContract({
  address: CONTRACT_ADDRESS,
  abi: CONTRACT_ABI,
  functionName: 'myUint'
})

console.log('ç”Ÿã®å€¤ï¼ˆBigIntï¼‰:', value)
console.log('æ–‡å­—åˆ—:', value.toString())
console.log('æ•°å€¤:', Number(value))
console.log('16é€²æ•°:', '0x' + value.toString(16))
console.log('2é€²æ•°:', value.toString(2))
```

## 2. æ›¸ãè¾¼ã¿æ“ä½œã®è©³ç´°

### 2.1 åŸºæœ¬çš„ãªæ›¸ãè¾¼ã¿

```typescript
// æ–¹æ³•1: åŸºæœ¬çš„ãªæ›¸ãè¾¼ã¿
// æ›¸ãè¾¼ã¿å‰ã®å€¤ã‚’ç¢ºèª
const beforeValue = await publicClient.readContract({
  address: CONTRACT_ADDRESS,
  abi: CONTRACT_ABI,
  functionName: 'myUint'
})
console.log('æ›¸ãè¾¼ã¿å‰ã®å€¤:', beforeValue.toString())

// å€¤ã‚’æ›´æ–°
const newValue = 50n
const hash = await walletClient.writeContract({
  address: CONTRACT_ADDRESS,
  abi: CONTRACT_ABI,
  functionName: 'setUint',
  args: [newValue]
})

console.log('ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒƒã‚·ãƒ¥:', hash)

// ç¢ºèªã‚’å¾…ã¤
const receipt = await publicClient.waitForTransactionReceipt({ hash })
console.log('ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:', receipt.status) // 'success' or 'reverted'
console.log('ãƒ–ãƒ­ãƒƒã‚¯ç•ªå·:', receipt.blockNumber.toString())
console.log('ä½¿ç”¨ã‚¬ã‚¹:', receipt.gasUsed.toString())

// æ›¸ãè¾¼ã¿å¾Œã®å€¤ã‚’ç¢ºèª
const afterValue = await publicClient.readContract({
  address: CONTRACT_ADDRESS,
  abi: CONTRACT_ABI,
  functionName: 'myUint'
})
console.log('æ›¸ãè¾¼ã¿å¾Œã®å€¤:', afterValue.toString())
```

### 2.2 ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³â†’æ›¸ãè¾¼ã¿ï¼ˆæ¨å¥¨ï¼‰

```typescript
// æ–¹æ³•2: ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³â†’æ›¸ãè¾¼ã¿
const newValue = 100n

// ã¾ãšã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆï¼ˆã‚¬ã‚¹ä»£ãªã—ã€ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ï¼‰
console.log('ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆä¸­...')
const { request } = await publicClient.simulateContract({
  address: CONTRACT_ADDRESS,
  abi: CONTRACT_ABI,
  functionName: 'setUint',
  args: [newValue],
  account
})

console.log('âœ… ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸï¼ˆã‚¨ãƒ©ãƒ¼ãªã—ï¼‰')

// ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸå¾Œã«å®Ÿè¡Œ
console.log('ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é€ä¿¡ä¸­...')
const hash = await walletClient.writeContract(request)

const receipt = await publicClient.waitForTransactionReceipt({ hash })
console.log('âœ… ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç¢ºèªå®Œäº†')
```

**ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ©ç‚¹**:
- ã‚¬ã‚¹ä»£ãŒã‹ã‹ã‚‰ãªã„
- ã‚¨ãƒ©ãƒ¼ã‚’äº‹å‰ã«æ¤œå‡º
- ã‚¬ã‚¹è¦‹ç©ã‚‚ã‚Šã‚’å–å¾—å¯èƒ½

### 2.3 è¤‡æ•°ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’é€£ç¶šå®Ÿè¡Œ

```typescript
// æ–¹æ³•3: è¤‡æ•°ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³
const values = [10n, 20n, 30n, 40n, 50n]

for (let i = 0; i < values.length; i++) {
  const value = values[i]
  console.log(`[${i + 1}/${values.length}] å€¤ã‚’ ${value} ã«æ›´æ–°ä¸­...`)
  
  const hash = await walletClient.writeContract({
    address: CONTRACT_ADDRESS,
    abi: CONTRACT_ABI,
    functionName: 'setUint',
    args: [value]
  })
  
  console.log('  TX:', hash.slice(0, 10) + '...')
  
  const receipt = await publicClient.waitForTransactionReceipt({ hash })
  console.log('  âœ… å®Œäº† (Gas:', receipt.gasUsed.toString() + ')')
}

// æœ€çµ‚å€¤ã‚’ç¢ºèª
const finalValue = await publicClient.readContract({
  address: CONTRACT_ADDRESS,
  abi: CONTRACT_ABI,
  functionName: 'myUint'
})

console.log('æœ€çµ‚å€¤:', finalValue.toString())
```

### 2.4 ã‚¬ã‚¹è¦‹ç©ã‚‚ã‚Š

```typescript
// æ–¹æ³•4: ã‚¬ã‚¹è¦‹ç©ã‚‚ã‚Š
const newValue = 200n

// ã‚¬ã‚¹è¦‹ç©ã‚‚ã‚Š
const gasEstimate = await publicClient.estimateContractGas({
  address: CONTRACT_ADDRESS,
  abi: CONTRACT_ABI,
  functionName: 'setUint',
  args: [newValue],
  account
})

console.log('æ¨å®šã‚¬ã‚¹é‡:', gasEstimate.toString())

// ã‚¬ã‚¹ä¾¡æ ¼ã‚’å–å¾—
const gasPrice = await publicClient.getGasPrice()
console.log('ã‚¬ã‚¹ä¾¡æ ¼:', gasPrice.toString(), 'wei')

// æ¨å®šã‚³ã‚¹ãƒˆï¼ˆweiï¼‰
const estimatedCost = gasEstimate * gasPrice
console.log('æ¨å®šã‚³ã‚¹ãƒˆ:', estimatedCost.toString(), 'wei')
console.log('æ¨å®šã‚³ã‚¹ãƒˆ:', Number(estimatedCost) / 1e18, 'ETH')

// ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
const hash = await walletClient.writeContract({
  address: CONTRACT_ADDRESS,
  abi: CONTRACT_ABI,
  functionName: 'setUint',
  args: [newValue],
  gas: gasEstimate
})

const receipt = await publicClient.waitForTransactionReceipt({ hash })

console.log('å®Ÿéš›ã®ã‚¬ã‚¹ä½¿ç”¨é‡:', receipt.gasUsed.toString())
console.log('å®Ÿéš›ã®ã‚³ã‚¹ãƒˆ:', Number(receipt.gasUsed * gasPrice) / 1e18, 'ETH')
```

**ã‚¬ã‚¹è¦‹ç©ã‚‚ã‚Šã®é‡è¦æ€§**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚³ã‚¹ãƒˆã‚’è¡¨ç¤º
- æ®‹é«˜ä¸è¶³ã‚’äº‹å‰ã«ãƒã‚§ãƒƒã‚¯
- æœ€é©ãªã‚¬ã‚¹ä¾¡æ ¼ã®è¨­å®š

### 2.5 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```typescript
// æ–¹æ³•5: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
try {
  // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
  await publicClient.simulateContract({
    address: CONTRACT_ADDRESS,
    abi: CONTRACT_ABI,
    functionName: 'setUint',
    args: [newValue],
    account
  })
  
  // æ›¸ãè¾¼ã¿
  const hash = await walletClient.writeContract({
    address: CONTRACT_ADDRESS,
    abi: CONTRACT_ABI,
    functionName: 'setUint',
    args: [newValue]
  })
  
  // ç¢ºèªï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆä»˜ãï¼‰
  const receipt = await publicClient.waitForTransactionReceipt({ 
    hash,
    timeout: 60_000
  })
  
  if (receipt.status === 'success') {
    console.log('âœ… ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æˆåŠŸ')
  } else {
    console.log('âŒ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¤±æ•—ï¼ˆrevertï¼‰')
  }
} catch (error: any) {
  console.error('âŒ ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ')
  
  if (error.message.includes('insufficient funds')) {
    console.error('  åŸå› : æ®‹é«˜ä¸è¶³')
  } else if (error.message.includes('nonce')) {
    console.error('  åŸå› : Nonce ã‚¨ãƒ©ãƒ¼')
  } else if (error.message.includes('gas')) {
    console.error('  åŸå› : ã‚¬ã‚¹ä¸è¶³')
  } else if (error.message.includes('revert')) {
    console.error('  åŸå› : ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆãŒãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ‹’å¦')
  }
}
```

**ä¸»è¦ãªã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ—**:
- **insufficient funds**: æ®‹é«˜ä¸è¶³
- **nonce**: nonceã‚¨ãƒ©ãƒ¼
- **gas**: ã‚¬ã‚¹ä¸è¶³
- **revert**: ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆå´ã§ã®æ‹’å¦

### 2.6 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®è¿½è·¡

```typescript
// æ–¹æ³•6: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¿½è·¡
console.log('ğŸ“¤ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é€ä¿¡å‰')
console.log('  é€ä¿¡å…ƒ:', account.address)
console.log('  ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ:', CONTRACT_ADDRESS)

const balanceBefore = await publicClient.getBalance({ 
  address: account.address 
})
console.log('  æ®‹é«˜:', Number(balanceBefore) / 1e18, 'ETH')

// é€ä¿¡
const hash = await walletClient.writeContract({
  address: CONTRACT_ADDRESS,
  abi: CONTRACT_ABI,
  functionName: 'setUint',
  args: [newValue]
})

console.log('â³ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é€ä¿¡å®Œäº†')
console.log('  Hash:', hash)

// ç¢ºèª
const receipt = await publicClient.waitForTransactionReceipt({ hash })

console.log('âœ… ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç¢ºèªå®Œäº†')
console.log('  ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:', receipt.status)
console.log('  ãƒ–ãƒ­ãƒƒã‚¯:', receipt.blockNumber.toString())
console.log('  ã‚¬ã‚¹ä½¿ç”¨:', receipt.gasUsed.toString())

const balanceAfter = await publicClient.getBalance({ 
  address: account.address 
})
const cost = balanceBefore - balanceAfter
console.log('  ã‚³ã‚¹ãƒˆ:', Number(cost) / 1e18, 'ETH')

// ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è©³ç´°ã‚’å–å¾—
const transaction = await publicClient.getTransaction({ hash })
console.log('ğŸ“‹ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è©³ç´°:')
console.log('  From:', transaction.from)
console.log('  To:', transaction.to)
console.log('  Value:', transaction.value.toString(), 'wei')
console.log('  Gas:', transaction.gas.toString())
```

## 3. å®Ÿè·µçš„ãªä½¿ç”¨ä¾‹

### 3.1 èª­ã¿å–ã‚Šæ“ä½œã®ä¾‹ï¼ˆERC20ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰

```typescript
// æ®‹é«˜ç¢ºèª
const myBalance = await contract.read.balanceOf(['0xMyAddress'])
console.log(`æ®‹é«˜: ${formatEther(myBalance)} tokens`)

// ç·ä¾›çµ¦é‡
const total = await contract.read.totalSupply()
console.log(`ç·ä¾›çµ¦é‡: ${formatEther(total)} tokens`)

// åå‰ã¨ã‚·ãƒ³ãƒœãƒ«
const name = await contract.read.name()
const symbol = await contract.read.symbol()
console.log(`${name} (${symbol})`)
```

### 3.2 æ›¸ãè¾¼ã¿æ“ä½œã®ä¾‹ï¼ˆERC-20ãƒˆãƒ¼ã‚¯ãƒ³ã®é€ä¿¡ï¼‰

```typescript
// 10ãƒˆãƒ¼ã‚¯ãƒ³ã‚’é€ä¿¡
const hash = await contract.write.transfer([
  '0xRecipientAddress',
  parseEther('10')
])

console.log('Transaction hash:', hash)

// ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç¢ºèªã‚’å¾…ã¤
const receipt = await publicClient.waitForTransactionReceipt({ hash })
console.log('Status:', receipt.status) // 'success' or 'reverted'
```

### 3.3 ETHã¨ä¸€ç·’ã«é€ä¿¡

```typescript
// NFTã‚’è³¼å…¥ï¼ˆ0.1 ETHæ”¯æ‰•ã„ï¼‰
await contract.write.buyNFT([tokenId], {
  value: parseEther('0.1')
})

// ã‚¹ãƒ†ãƒ¼ã‚­ãƒ³ã‚°ï¼ˆ1 ETHé ã‘ã‚‹ï¼‰
await contract.write.stake([], {
  value: parseEther('1')
})
```

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ**:
- `value`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ETHã‚’é€ä¿¡
- `parseEther()` ã§ETHã‚’Weiã«å¤‰æ›

### 3.4 ã‚¤ãƒ™ãƒ³ãƒˆã®ç›£è¦–

#### éå»ã®ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—

```typescript
const logs = await publicClient.getContractEvents({
  address: contractAddress,
  abi: contractABI,
  eventName: 'Transfer',
  fromBlock: 1000000n,
  toBlock: 'latest'
})

console.log('éå»ã®é€é‡‘å±¥æ­´:', logs)
```

#### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–

```typescript
const unwatch = publicClient.watchContractEvent({
  address: contractAddress,
  abi: contractABI,
  eventName: 'Transfer',
  onLogs: (logs) => {
    logs.forEach(log => {
      console.log(`é€é‡‘: ${log.args.from} â†’ ${log.args.to}`)
      console.log(`é‡‘é¡: ${formatEther(log.args.value)}`)
    })
  }
})

// ç›£è¦–åœæ­¢
// unwatch()
```

## 4. å®Ÿè·µçš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¾‹

### 4.1 DEXã§ã®å–å¼•ä¾‹

```typescript
// 1. ç¾åœ¨ã®ä¾¡æ ¼ã‚’ç¢ºèªï¼ˆèª­ã¿å–ã‚Šï¼‰
const price = await dexContract.read.getPrice(['USDC', 'ETH'])
console.log(`1 ETH = ${price} USDC`)

// 2. è‡ªåˆ†ã®æ®‹é«˜ã‚’ç¢ºèªï¼ˆèª­ã¿å–ã‚Šï¼‰
const usdcBalance = await usdcContract.read.balanceOf([myAddress])
console.log(`USDCæ®‹é«˜: ${formatUnits(usdcBalance, 6)}`)

// 3. DEXã«USDCã®ä½¿ç”¨è¨±å¯ã‚’ä¸ãˆã‚‹ï¼ˆæ›¸ãè¾¼ã¿ï¼‰
const approveHash = await usdcContract.write.approve([
  dexAddress,
  parseUnits('1000', 6) // 1000 USDC
])
await publicClient.waitForTransactionReceipt({ hash: approveHash })

// 4. ã‚¹ãƒ¯ãƒƒãƒ—ã‚’å®Ÿè¡Œï¼ˆæ›¸ãè¾¼ã¿ï¼‰
const swapHash = await dexContract.write.swap([
  'USDC',
  'ETH',
  parseUnits('1000', 6), // 1000 USDC
  parseEther('0.4')      // æœ€ä½0.4 ETHå—å–
])
await publicClient.waitForTransactionReceipt({ hash: swapHash })

// 5. çµæœã‚’ç¢ºèªï¼ˆèª­ã¿å–ã‚Šï¼‰
const newBalance = await publicClient.getBalance({ address: myAddress })
console.log(`æ–°ã—ã„ETHæ®‹é«˜: ${formatEther(newBalance)}`)
```

### 4.2 NFTãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹

```typescript
// 1. NFTãŒè²©å£²ä¸­ã‹ç¢ºèªï¼ˆèª­ã¿å–ã‚Šï¼‰
const listing = await marketContract.read.getListing([tokenId])
console.log(`ä¾¡æ ¼: ${formatEther(listing.price)} ETH`)
console.log(`è²©å£²è€…: ${listing.seller}`)

// 2. è‡ªåˆ†ã®ETHæ®‹é«˜ã‚’ç¢ºèªï¼ˆèª­ã¿å–ã‚Šï¼‰
const balance = await publicClient.getBalance({ address: myAddress })

if (balance < listing.price) {
  console.log('æ®‹é«˜ä¸è¶³')
  return
}

// 3. NFTã‚’è³¼å…¥ï¼ˆæ›¸ãè¾¼ã¿ + ETHé€ä¿¡ï¼‰
const hash = await marketContract.write.buyNFT([tokenId], {
  value: listing.price
})

await publicClient.waitForTransactionReceipt({ hash })

// 4. NFTã®æ‰€æœ‰æ¨©ã‚’ç¢ºèªï¼ˆèª­ã¿å–ã‚Šï¼‰
const owner = await nftContract.read.ownerOf([tokenId])
console.log(`æ–°ã—ã„ã‚ªãƒ¼ãƒŠãƒ¼: ${owner}`)
console.log(`è³¼å…¥æˆåŠŸ: ${owner === myAddress}`)
```

### 4.3 DeFiãƒ¬ãƒ³ãƒ‡ã‚£ãƒ³ã‚°

```typescript
// 1. ç¾åœ¨ã®APYï¼ˆå¹´åˆ©ï¼‰ã‚’ç¢ºèªï¼ˆèª­ã¿å–ã‚Šï¼‰
const apy = await lendingContract.read.getSupplyAPY()
console.log(`ä¾›çµ¦APY: ${apy / 100}%`)

// 2. è‡ªåˆ†ã®é é‡‘é¡ã‚’ç¢ºèªï¼ˆèª­ã¿å–ã‚Šï¼‰
const deposited = await lendingContract.read.balanceOf([myAddress])
console.log(`é é‡‘: ${formatEther(deposited)} ETH`)

// 3. è¿½åŠ ã§é é‡‘ï¼ˆæ›¸ãè¾¼ã¿ + ETHé€ä¿¡ï¼‰
const depositHash = await lendingContract.write.deposit([], {
  value: parseEther('5') // 5 ETHé ã‘ã‚‹
})
await publicClient.waitForTransactionReceipt({ hash: depositHash })

// 4. åˆ©æ¯ã‚’ç¢ºèªï¼ˆèª­ã¿å–ã‚Šï¼‰
const interest = await lendingContract.read.getAccruedInterest([myAddress])
console.log(`ç²å¾—åˆ©æ¯: ${formatEther(interest)} ETH`)

// 5. å¼•ãå‡ºã—ï¼ˆæ›¸ãè¾¼ã¿ï¼‰
const withdrawHash = await lendingContract.write.withdraw([
  parseEther('2') // 2 ETHå¼•ãå‡ºã™
])
await publicClient.waitForTransactionReceipt({ hash: withdrawHash })
```

## 5. ã§ãã‚‹ã“ã¨ã®ã¾ã¨ã‚

### 5.1 ãƒ‡ãƒ¼ã‚¿å–å¾—

âœ… æ®‹é«˜ã€ä¾¡æ ¼ã€æ•°é‡ã®ç¢ºèª  
âœ… æ‰€æœ‰æ¨©ã®ç¢ºèª  
âœ… åˆ©ç‡ã€æ‰‹æ•°æ–™ã®è¨ˆç®—  
âœ… çŠ¶æ…‹ã®ç¢ºèªï¼ˆæ‰¿èªæ¸ˆã¿ã‹ã€æœ‰åŠ¹ã‹ç­‰ï¼‰

### 5.2 è³‡ç”£æ“ä½œ

âœ… ãƒˆãƒ¼ã‚¯ãƒ³ã®é€ä¿¡ãƒ»å—ä¿¡  
âœ… NFTã®è»¢é€ãƒ»ãƒŸãƒ³ãƒˆ  
âœ… ãƒˆãƒ¼ã‚¯ãƒ³ã®äº¤æ›ï¼ˆã‚¹ãƒ¯ãƒƒãƒ—ï¼‰  
âœ… ã‚¹ãƒ†ãƒ¼ã‚­ãƒ³ã‚°ãƒ»ã‚¢ãƒ³ã‚¹ãƒ†ãƒ¼ã‚­ãƒ³ã‚°

### 5.3 æ‰¿èªãƒ»è¨±å¯

âœ… ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨è¨±å¯ï¼ˆApprovalï¼‰  
âœ… ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼è¨­å®š  
âœ… æ¨©é™ã®å§”è­²

### 5.4 é‡‘èæ“ä½œ

âœ… é é‡‘ãƒ»å¼•ãå‡ºã—  
âœ… å€Ÿå…¥ãƒ»è¿”æ¸ˆ  
âœ… å ±é…¬ã®è«‹æ±‚  
âœ… æ‰‹æ•°æ–™ã®æ”¯æ‰•ã„

### 5.5 ã‚¤ãƒ™ãƒ³ãƒˆè¿½è·¡

âœ… éå»ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å±¥æ­´  
âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥  
âœ… ä¾¡æ ¼å¤‰å‹•ã®ç›£è¦–  
âœ… æ´»å‹•ãƒ­ã‚°ã®å–å¾—

## 6. åˆ¶é™äº‹é …ã¨æ³¨æ„ç‚¹

### 6.1 ã§ããªã„ã“ã¨

âŒ **ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆå¤‰æ•°ã®ç›´æ¥èª­ã¿å–ã‚Š**  
âŒ **ä»–äººã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‹ã‚‰ã®é€ä¿¡**ï¼ˆç§˜å¯†éµãŒå¿…è¦ï¼‰  
âŒ **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®å–ã‚Šæ¶ˆã—**ï¼ˆä¸€åº¦é€ä¿¡ã—ãŸã‚‰ä¸å¯é€†ï¼‰  
âŒ **ã‚¬ã‚¹ä»£ãªã—ã§ã®çŠ¶æ…‹å¤‰æ›´**

### 6.2 é‡è¦ãªæ³¨æ„ç‚¹

1. **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸å¯é€†æ€§**: ä¸€åº¦é€ä¿¡ã—ãŸãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¯å–ã‚Šæ¶ˆã›ãªã„
2. **ã‚¬ã‚¹ä»£ã®ç¢ºèª**: å¸¸ã«ã‚¬ã‚¹ä»£ã‚’ç¢ºèªã—ã€æ®‹é«˜ãŒååˆ†ã‹ãƒã‚§ãƒƒã‚¯
3. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: å¿…ãštry-catchæ–‡ã§ã‚¨ãƒ©ãƒ¼ã‚’æ•æ‰
4. **ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æ´»ç”¨**: `simulateContract()`ã§äº‹å‰ã«ã‚¨ãƒ©ãƒ¼ã‚’ãƒã‚§ãƒƒã‚¯

## 7. å­¦ç¿’ã®ãƒã‚¤ãƒ³ãƒˆ

### 7.1 ç¿’å¾—ã—ãŸæŠ€è¡“

1. **èª­ã¿å–ã‚Šæ“ä½œã®å¤šæ§˜ãªæ–¹æ³•**
   - åŸºæœ¬çš„ãªèª­ã¿å–ã‚Š
   - ä½ãƒ¬ãƒ™ãƒ«API
   - è¤‡æ•°å›ã®é€£ç¶šèª­ã¿å–ã‚Š
   - å®šæœŸçš„ãªç›£è¦–
   - ãƒ–ãƒ­ãƒƒã‚¯æƒ…å ±ä»˜ã
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
   - å€¤ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

2. **æ›¸ãè¾¼ã¿æ“ä½œã®å¤šæ§˜ãªæ–¹æ³•**
   - åŸºæœ¬çš„ãªæ›¸ãè¾¼ã¿
   - ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãæ›¸ãè¾¼ã¿
   - è¤‡æ•°ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é€£ç¶šå®Ÿè¡Œ
   - ã‚¬ã‚¹è¦‹ç©ã‚‚ã‚Š
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
   - ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¿½è·¡

3. **å®Ÿè·µçš„ãªä½¿ç”¨ä¾‹**
   - ERC-20ãƒˆãƒ¼ã‚¯ãƒ³æ“ä½œ
   - NFTãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹
   - DeFiãƒ¬ãƒ³ãƒ‡ã‚£ãƒ³ã‚°
   - DEXå–å¼•

### 7.2 é‡è¦ãªç†è§£äº‹é …

1. **èª­ã¿å–ã‚Šã¨æ›¸ãè¾¼ã¿ã®é•ã„**
   - èª­ã¿å–ã‚Š: Public Clientã€ã‚¬ã‚¹ä»£ä¸è¦
   - æ›¸ãè¾¼ã¿: Wallet Clientã€ã‚¬ã‚¹ä»£å¿…è¦ã€ç½²åå¿…è¦

2. **ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®é‡è¦æ€§**
   - ã‚¬ã‚¹ä»£ã‚’ç¯€ç´„
   - ã‚¨ãƒ©ãƒ¼ã‚’äº‹å‰ã«æ¤œå‡º
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®å‘ä¸Š

3. **ã‚¤ãƒ™ãƒ³ãƒˆç›£è¦–ã®æ´»ç”¨**
   - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
   - åŠ¹ç‡çš„ãªãƒ‡ãƒ¼ã‚¿å–å¾—
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥

### 7.3 å®Ÿè·µçš„ãªã‚¹ã‚­ãƒ«

1. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
2. **ã‚¬ã‚¹æœ€é©åŒ–**
3. **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¿½è·¡**
4. **ã‚¤ãƒ™ãƒ³ãƒˆç›£è¦–**

## 8. ã¾ã¨ã‚

2025å¹´10æœˆ27æ—¥ã¯ã€Viemã‚’ä½¿ç”¨ã—ãŸã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®èª­ã¿å–ã‚Šãƒ»æ›¸ãè¾¼ã¿æ“ä½œã®å¤šæ§˜ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å®Ÿè·µçš„ãªä½¿ç”¨ä¾‹ã‚’å­¦ç¿’ã—ã¾ã—ãŸã€‚èª­ã¿å–ã‚Šã¨æ›¸ãè¾¼ã¿ã®åŸºæœ¬çš„ãªæ“ä½œã‹ã‚‰ã€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚¬ã‚¹è¦‹ç©ã‚‚ã‚Šã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€ã‚¤ãƒ™ãƒ³ãƒˆç›£è¦–ã¾ã§ã€åŒ…æ‹¬çš„ãªç†è§£ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

### 8.1 é‡è¦ãªæˆæœ

- **å¤šæ§˜ãªèª­ã¿å–ã‚Šæ–¹æ³•ã®ç¿’å¾—**
- **å®‰å…¨ãªæ›¸ãè¾¼ã¿æ–¹æ³•ã®ç¿’å¾—**
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®Ÿè·µ**
- **å®Ÿè·µçš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¾‹ã®ç†è§£**

### 8.2 ä»Šå¾Œã®å­¦ç¿’æ–¹å‘

- **ã‚ˆã‚Šè¤‡é›‘ãªã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨ã®å¯¾è©±**
- **ãƒãƒ«ãƒã‚·ã‚°ãƒãƒãƒ£ã¨ã‚¦ã‚©ãƒ¬ãƒƒãƒˆçµ±åˆ**
- **ã‚ªãƒ•ãƒã‚§ãƒ¼ãƒ³åŒæœŸã¨ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°**
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®æœ€é©åŒ–**

